/*
  Dash Royale - Full Replacement with Persistent State & Set Time Buttons
*/

/*********************
  SAVE / LOAD
*********************/
if(!localStorage.getItem("crowns")) localStorage.setItem("crowns","0");
if(!localStorage.getItem("arena")) localStorage.setItem("arena","1");
if(!localStorage.getItem("deck")) localStorage.setItem("deck",JSON.stringify(["knight","archer","giant","goblin"]));
if(!localStorage.getItem("levels")) {
  const initLevels={};
  Object.keys(cards).forEach(c=>initLevels[c]=1);
  localStorage.setItem("levels",JSON.stringify(initLevels));
}

let crowns = Number(localStorage.getItem("crowns"));
let currentArena = Number(localStorage.getItem("arena"));
let deck = JSON.parse(localStorage.getItem("deck"));
let levels = JSON.parse(localStorage.getItem("levels"));
let gameInterval = null;
let selectedTime = Number(localStorage.getItem("selectedTime")) || 180;

function save(){
  localStorage.setItem("crowns",crowns);
  localStorage.setItem("arena",currentArena);
  localStorage.setItem("deck",JSON.stringify(deck));
  localStorage.setItem("levels",JSON.stringify(levels));
  localStorage.setItem("selectedTime",selectedTime);
}

/*********************
  SET TIME BUTTONS
*********************/
function setGameTime(seconds){
  selectedTime = seconds;
  save();
  startTimer(selectedTime);
}

/*********************
  INITIALIZE UI
*********************/
goMenu(); // redraw arenas and home screen immediately on load
